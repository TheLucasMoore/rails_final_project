<h1><%= @ingredient.name %> Ingredient Page</h1>

<p>Ok, cool you have some <%= @ingredient.name %> in your fridge. Check out all the recipes we have and cook something with it!</p>
<p>Click the link to see more about each recipe.</p>

<h3>Recipes Using This Ingredient</h3>

<ul>
<% @ingredient.recipes.each do |recipe| %>
  <li><%= link_to recipe.name, recipe_path(recipe), id: :recipe %></li>
  <h1 id="recipe-<%= recipe.id %>"></h1>
  <p id="recipe-<%= recipe.id %>"></p>
<% end %>
</ul>

<% content_for :ingredient do %>
  <script>
  $(function() {
    linkOverride();
  });

  var linkOverride = function() {
    $("#recipe").click(function(event) {
      event.preventDefault();
      loadRecipes(event["target"]["href"]);
    });
  }

  function loadRecipes(target_url) {
    $.getJSON (target_url + ".json", function(result) {
      handleResponse(result);
      })
    };

  var handleResponse = function(result) {
    var id = result['recipe']['id'];
    var name = result['recipe']['name'];
    var description = result['recipe']['description'];
      $("h1#recipe-" + id).text(name);
      $("p#recipe-" + id).text(description);
  };

  </script>
<% end %>